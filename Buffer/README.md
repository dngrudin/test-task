# Buffer

1. Клиент хочет получить набор блоков данных стандартного размера от сервера. Хэш-таблица блоков представлена как set. Хэш таблицу клиент отправляет серверу. Размер одинаков для всех блоков, но нужно предусмотреть возможность того, что размер блоков может быть изменен (сейчас 16к, завтра 128к например). Кроме того в посылке от сервера клиенту должна быть предусмотрена информация о реальной длине блока данных (передаем 16к, на диск нужно записать только 100 байт - последний блок какого-то файла).
2. Блоки данных на сервере располагаются в блочном устройстве, например /dev/sdс, в случайном порядке. Это можно рассматривать как очень большой файл, например 10Тб, в нем заведомо больше блоков чем запрашивает клиент.
3. Сервер неким волшебным образом очень быстро может узнать номер блока по хэшу с помощью size_t get_block_number(const string hash);
4. Сервер неким волшебным образом очень быстро может вернуть реальный размер блока в байтах чтобы клиент записал на диск только то что нужно с помощью size_t get_block_size(const string hash);

Задача:
наиболее элегантным образом, с особым вниманием к производительности, сформировать в памяти буфер с данными из блочного устройства в том же порядке что и в хэш-таблице для последующей передачи клиенту, при этом нужно предусмотреть возможность информировать клиента о реальном размере блока, который нужно использовать (например 100 байт, а не 16к).
